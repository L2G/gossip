---
layout: site
title: Cronies
include_toc: true
validation_rev: 2
validated: true
---
<h2>The different cronies</h2>

<p>
Here are the capsule descriptions:
</p>

<ul>
<li><p>The <strong><a href="#campfire">campfire crony</a></strong> talks to <a href="http://campfirenow.com/" title="Business chat for groups: Campfire">Campfire</a>, a browser-based chat room.</p></li>

<li><p>The <strong><a href="#jabber">jabber crony</a></strong> talks <a href="http://www.jabber.org/" title="Jabber: Open Instant Messaging and a Whole Lot More, Powered by XMPP">Jabber</a>, a chat protocol with servers that are easy to set up, making it nice for workgroups.</p></li>

<li><p>The <strong><a href="#mail">mail crony</a></strong> speaks to email servers via the SMTP protocol. SSL is not supported.</p></li>

<li><p>The <strong><a href="#stdout">standard output crony</a></strong> just sends mail to standard output (the current window). It's useful checking whether (for example), you're using <code>watchdog</code> correctly before blasting the results to the entire world.</p></li>

<li><p>The <strong><a href="#trac">trac crony</a></strong> puts a notice in a <a href="http://trac.edgewall.org/" title="The Trac Project - Trac">Trac</a> timeline.</p></li>

<li><p>The <strong><a href="#twitter">twitter crony</a></strong> sends an update to a <a href="http://twitter.com/home" title="Twitter">Twitter</a> account.</p></li>
</ul>

<h2><a name="campfire">Campfire</a></h2>

<p>My configuration file turns the <code>campfile</code> crony off. I can turn
it on with the <code>-c</code> (or <code>--campfire</code>) option, like
this:</p>

<pre>
   % watchdog -c rake
</pre>

<p>
The result at wevouchfor.campfirenow.com looks like this:
</p>

<img class="center" src="images/campfire.png" alt="Screen shot showing
testunit output at wevouchfor.campfirenow.com" />

<p>
The scandal is the first line of the message; the details are the rest.
</p>

<p>
To use the <code>campfire</code> crony, you must have a <a href="http://campfirenow.com/" title="Business chat for groups: Campfire">Campfire</a> account with a chat room set up. Set the following in a configuration file or on the command line:
</p>

<ul>
<li><strong>campfire-login</strong>: Usually an email address.</li>
<li><strong>campfire-password</strong></li>
<li><strong>campfire-subdomain</strong>: Each campfire group gets its own subdomain. Mine is <a href="http://wevouchfor.campfirenow.com/" title="We Vouch For...">http://wevouchfor.campfirenow.com</a>. So my value for this choice is <code>wevouchfor</code>.</li>
<li><strong>campfire-room</strong>: A group can have multiple rooms, each with its own name. The one I've used in this case is <code>wevouchfor activity</code>.</li>
</ul>

<h2><a name="jabber">Jabber</a></h2>
<p>
Here is an example of a continuous build server telling jabber (and perhaps other cronies) about a broken build:
</p>

<img class="center" src="images/jabber-big.png" alt="Screen shot of Jabber
chat showing testunit output" />

<p>
The scandal is the first line of the message; the details are the rest.
</p>

<p>
To use the <code>jabber</code> crony, you must have an account on some <a href="http://www.jabber.org/" title="Jabber: Open Instant Messaging and a Whole Lot More, Powered by XMPP">Jabber</a> server. In this example, Jabber messages come from <code>huivoufor@jabber.se</code>.
</p>


<ul>
<li><strong>jabber-account</strong>: <code>huivoufor@jabber.se</code>, in this case.</li>
<li><strong>jabber-password</strong></li>
<li><strong>jabber-to</strong>: One or more accounts to sent to. In YAML, that would look like this: 
<pre>
jabber-to: 
    - brianmarick@jabberplace.org
    - someone@xmpphost.org
</pre>

<p>If you only want one account to receive the message, you can abbreviate
the YAML to this:
</p>
<pre>
jabber-to: brianmarick@jabberplace.org
</pre>

<p>On the command line, multiple accounts are separated by commas, like
this:</p>
<pre>
 --jabber-to=fred@example.com,brianmarick@example.com 
</pre>

</li>
</ul>

<h2><a name="mail">Mail</a></h2>
<p>
When mail is sent, the scandal is used as the subject line and the details are put into the body. Here are the choices you have to make:
</p>
<ul>
<li><strong>mail-from</strong>: What's put in the From line of the mail message.</li>
<li><strong>mail-to</strong>: The intended recipients.
<pre>
    mail-to: 
    - marick@example.com
    - person@example.org
</pre>

<p>If you only want one account to receive the mail, you can abbreviate
the YAML to this:
</p>
<pre>
    mail-to: marick@example.com
</pre>

<p>On the command line, multiple accounts are separated by commas, like
this:</p>
<pre>
    --mail-to=marick@example.com,person@example.com 
</pre>
</li>
<li><strong>mail-server</strong>: An SMTP server.</li>
<li><strong>mail-port</strong></li>
<li><strong>mail-from-domain</strong>: The domain the mail claims to be from. Some SMTP servers look at this. The default is localhost.</li>
<li><strong>mail-account</strong>: An account on the server. Not necessarily the same as <code>mail-from</code>.</li>
<li><strong>mail-authentication</strong>: One of <code>plain</code>, <code>login</code>, or <code>cram_md5</code>.</li>
<li><strong>mail-password</strong></li>
</ul>

<h2><a name="stdout">Standard output</a></h2>
<p>This crony just prints the scandal and details to the current terminal window. There are no options.</p>
<h2><a name="trac">Trac</a></h2>
<p>
The <code>trac</code> crony puts a notice in the <a href="http://trac.edgewall.org/" title="The Trac Project - Trac">Trac</a> timeline, where it looks like this:
</p>

<img class="center" src="images/trac-bigger.png" alt="Screen shot of Trac
timeline showing notices: &quot;AnnouncingSuccessfulDeployment edited by trac&quot;" />

<p>
The mechanism is a hack. To do it right, you'd have to write a plugin and enable XMP/RPC and whatnot. So the implementation is to edit a Wiki page, turning the scandal into a header and putting the details below it. That looks like this:
</p>

<img class="center" src="images/trac-detail.png" alt="Screen shot of Trac wiki
page showing deployment announcements" />

<p>
Then, if the Trac timeline is set to display changes to Wiki pages (configurable per-user on the Timeline page), the changed page's title will appear in the Timeline. You have to click through to see the scandal and details.
</p>

<p>
To further ease the implementation, the editing of the Wiki page is done on the server with the <code>trac-admin</code> command. That means the Gossip script has to run on the server too.
</p>

<p>It would be swell if someone were to contribute a less hackish implementation.
</p>
<p>
To use this implementation, you have to set the following:
</p>
<ul>
<li><strong>trac-admin-path</strong>: The full path of the <code>trac-admin</code> program.</li>
<li><strong>trac-environment-path</strong>: The full path of the Trac environment you're using (such as <code>/home/user/trac_env1</code>).</li>
<li><strong>trac-page-name</strong>: The name of the wiki page to change.</li>
<li><strong>trac-content-file</strong>: The wiki page is changed by copying this file over its contents. Before the Trac crony does that, it puts the scandal and details at the beginning.</li>
</ul>

<h2><a name="twitter">Twitter</a></h2>
<p>
Because <a href="http://twitter.com/home" title="Twitter">Twitter</a> is meant for short messages, only the scandal is sent:
</p>
<img class="center" src="images/twitter.png" alt="Screen shot of Twitter post:
&quot;Build is BROKEN&quot;" />

<p>
To use the <code>twitter</code> crony, you need a Twitter account. Messages are sent to that account for others to view. The configuration options are:
</p>
<ul>
<li><strong>twitter-login</strong></li>
<li><strong>twitter-password</strong></li>
</ul>

<p style="text-align: center">
<a href="scripts.html">Next</a>: All scripts<br />
</p>
